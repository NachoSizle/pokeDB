---
// üïµÔ∏è‚Äç‚ôÇÔ∏è P√°gina de depuraci√≥n para variables de entorno en Vercel (versi√≥n simplificada)

const dbUrl = import.meta.env.ASTRO_DB_URL;
const authToken = import.meta.env.ASTRO_DB_AUTH_TOKEN;

const debugInfo = {
  dbUrl: {
    value: dbUrl,
    isDefined: dbUrl !== undefined && dbUrl !== null,
    hasValue: !!dbUrl,
  },
  authToken: {
    isDefined: authToken !== undefined && authToken !== null,
    hasValue: !!authToken,
    length: authToken?.length || 0,
    partialValue: authToken ? `${authToken.substring(0, 4)}...` : 'No disponible',
  }
};
---
<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Debug de Variables de Entorno</title>
  <style>
    body { font-family: sans-serif; background-color: #111; color: #eee; padding: 2rem; }
    .container { max-width: 800px; margin: auto; background-color: #222; border: 1px solid #444; border-radius: 8px; padding: 2rem; }
    h1 { color: #ffc107; }
    h2 { color: #fd7e14; }
    code { background-color: #333; padding: 0.2rem 0.4rem; border-radius: 4px; }
    .required-action { background-color: #4d1a1a; border: 1px solid #993333; padding: 1rem; border-radius: 8px; margin-top: 2rem; }
  </style>
</head>
<body>
  <div class="container">
    <h1>Diagn√≥stico del Entorno de Vercel</h1>
    <p>Resultados de la lectura de variables de entorno en el servidor.</p>
    
    <div>
      <h2>ASTRO_DB_URL</h2>
      <p><strong>¬øEst√° definida?</strong> {debugInfo.dbUrl.isDefined ? '‚úÖ S√≠' : '‚ùå No'}</p>
      <p><strong>¬øTiene valor?</strong> {debugInfo.dbUrl.hasValue ? '‚úÖ S√≠' : '‚ùå No'}</p>
      <p><strong>Valor:</strong> <code>{debugInfo.dbUrl.value || 'No se encontr√≥ valor'}</code></p>
    </div>

    <hr style="border-color: #444; margin: 1rem 0;" />

    <div>
      <h2>ASTRO_DB_AUTH_TOKEN</h2>
      <p><strong>¬øEst√° definida?</strong> {debugInfo.authToken.isDefined ? '‚úÖ S√≠' : '‚ùå No'}</p>
      <p><strong>¬øTiene valor?</strong> {debugInfo.authToken.hasValue ? '‚úÖ S√≠' : '‚ùå No'}</p>
      <p><strong>Longitud:</strong> <code>{debugInfo.authToken.length}</code></p>
      <p><strong>Valor parcial (seguro):</strong> <code>{debugInfo.authToken.partialValue}</code></p>
    </div>

    <div class="required-action">
      <h3>Acci√≥n Requerida</h3>
      <p>
        Si alguna variable aparece como "No definida" o con longitud 0, el problema es que
        Vercel no la est√° proporcionando a la aplicaci√≥n. Debes verificar de nuevo la configuraci√≥n
        de las variables de entorno en el dashboard de tu proyecto en Vercel y asegurarte de que
        est√°n asignadas al entorno de "Production". Tras guardarlas, inicia un nuevo despliegue ("Redeploy").
      </p>
    </div>
  </div>
</body>
</html>